<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AKROFISIO - Nossa Estrutura</title>
    <!-- Correção: 'xintegrity' para 'integrity' -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" xintegrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="imagem/logo.png" type="image/png">
    <!-- Adicione a importação da fonte "Inter" ou "Stevie Sans" aqui, se ainda não estiver fazendo isso -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">
                <img src="imagem/logo_erianrazera 2.png" alt="Logotipo da Sua Clínica">
            </div>
            <button class="menu-toggle" aria-expanded="false" aria-controls="nav-list" aria-label="Abrir/Fechar Menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <nav class="main-nav">
               <ul id="nav-list">
                    <li><a href="index.html">Início</a></li>
                    <li><a href="clinica.html">A Clinica</a></li>
                    <li><a href="servicos.html">Serviços</a></li>
                    <li><a href="blog.html">Blog</a></li>
                    <li><a href="contato.html">Contato</a></li>
                </ul>
            </nav>
        </div>
    </header>
    
    <!-- Fim do formulário flutuante -->

    <main>
        <section class="estrutura-intro">
            <div class="container">
                <h2>Conheça Nossa Estrutura</h2>
                <p>Convidamos você para um tour virtual pelos nossos ambientes, projetados para o seu conforto e bem-estar.</p>
            </div>
        </section>

        <section class="galeria-ambientes">
            <div class="container">
                <div class="ambiente-item">
                    <div class="ambiente-gallery">
                        <!-- Adicionado data-fullsrc para a imagem em tela cheia -->
                        <img src="imagem/img1.jpeg" alt="[Image of Recepção da Clínica Akrofisio 1]" data-fullsrc="imagem/img1.jpeg">
                        <img src="imagem/img2.jpeg" alt="[Image of Recepção da Clínica Akrofisio 2]" data-fullsrc="imagem/img2.jpeg">
                        <img src="imagem/img3.jpeg" alt="[Image of Recepção da Clínica Akrofisio 3]" data-fullsrc="imagem/img3.jpeg">
                        <img src="imagem/img4.jpeg" alt="[Image of Recepção da Clínica Akrofisio 4]" data-fullsrc="imagem/img4.jpeg">
                        <img src="imagem/img5.jpeg" alt="[Image of Recepção da Clínica Akrofisio 5]" data-fullsrc="imagem/img5.jpeg">
                    </div>
                    <div class="ambiente-info">
                        <h3>Recepção Acolhedora</h3>
                        <p>Nosso espaço de recepção é pensado para que você se sinta à vontade desde o primeiro momento. Ambiente tranquilo e confortável para sua espera.</p>
                    </div>
                </div>

                <div class="ambiente-item invertido">
                    <div class="ambiente-gallery">
                        <img src="imagem/loc1.jpeg" alt="[Image of Fachada da Clínica Akrofisio 1]" data-fullsrc="imagem/loc1.jpeg">
                        <img src="imagem/loc2.jpeg" alt="[Image of Fachada da Clínica Akrofisio 2]" data-fullsrc="imagem/loc2.jpeg">
                        <img src="imagem/loc3.jpeg" alt="[Image of Fachada da Clínica Akrofisio 3]" data-fullsrc="imagem/loc3.jpeg">
                    </div>
                    <div class="ambiente-info">
                        <h3>Localização Privilegiada</h3>
                        <p>Com fácil acesso e uma fachada moderna, nossa clínica está pronta para recebê-lo em um ponto estratégico da cidade.</p>
                    </div>
                </div>

                <div class="ambiente-item">
                    <div class="ambiente-gallery">
                    <div class="ambiente-gallery">
                        <img src="imagem/at.jpeg" alt="[Image of Sala de Exercício Livre e Reabilitação 1]">
                        <img src="imagem/at2.jpeg" alt="[Image of Sala de Exercício Livre e Reabilitação 2]">
                        <img src="imagem/at3.jpeg" alt="[Image of Sala de Exercício Livre e Reabilitação 3]">
                    </div>
                    </div>
                    <div class="ambiente-info">
                        <h3>Salas de Atendimento</h3>
                        <p>Ambientes equipados com o que há de mais moderno, garantindo privacidade e foco total em seu tratamento individualizado.</p>
                    </div>
                </div>

                <div class="ambiente-item invertido">
                    <div class="ambiente-gallery">
                        <img src="imagem/livre1.jpeg" alt="[Image of Sala de Exercício Livre e Reabilitação 1]" data-fullsrc="imagem/livre1.jpeg">
                        <img src="imagem/livre2.jpeg" alt="[Image of Sala de Exercício Livre e Reabilitação 2]" data-fullsrc="imagem/livre2.jpeg">
                    
                    </div>
                    <div class="ambiente-info">
                        <h3>Espaço de Exercício Livre</h3>
                        <p>Uma área ampla e equipada para a sua reabilitação e fortalecimento, com acompanhamento profissional para cada etapa do seu progresso.</p>
                    </div>
                </div>

                <div class="ambiente-item">
                    <div class="ambiente-gallery">
                        <img src="imagem/plt1.jpeg" alt="[Image of Estúdio de Pilates Akrofisio 1]" data-fullsrc="imagem/plt1.jpeg">
                        <img src="imagem/plt2.jpeg" alt="[Image of Estúdio de Pilates Akrofisio 2]" data-fullsrc="imagem/plt2.jpeg">
                        <img src="imagem/plt3.jpeg" alt="[Image of Estúdio de Pilates Akrofisio 3]" data-fullsrc="imagem/plt3.jpeg">
                        <img src="imagem/plt4.jpeg" alt="[Image of Estúdio de Pilates Akrofisio 4]" data-fullsrc="imagem/plt4.jpeg">
                    </div>
                    <div class="ambiente-info">
                        <h3>Estúdio de Pilates</h3>
                        <p>Desfrute de um estúdio completo de Pilates, ideal para melhorar sua postura, flexibilidade e força em um ambiente tranquilo e dedicado.</p>
                    </div>
                </div>

                <div class="ambiente-item invertido">
                    <div class="ambiente-gallery">
                        <img src="imagem/b1.jpeg" alt="[Image of Banheiro Adaptado para Acessibilidade 1]" data-fullsrc="imagem/b1.jpeg">
                        <img src="imagem/b2.jpeg" alt="[Image of Banheiro Adaptado para Acessibilidade 2]" data-fullsrc="imagem/b2.jpeg">
                        <img src="imagem/b3.jpeg" alt="[Image of Banheiro Adaptado para Acessibilidade 3]" data-fullsrc="imagem/b3.jpeg">
                    </div>
                    <div class="ambiente-info">
                        <h3>Banheiro Adaptado</h3>
                        <p>Nosso compromisso com a inclusão se reflete em nosso banheiro totalmente adaptado, garantindo conforto e segurança para todos os pacientes.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="call-to-action-estrutura">
            <div class="container">
                <h2>Venha nos Visitar!</h2>
                <p>Agende um horário e conheça pessoalmente a estrutura completa da AKROFISIO.</p>
                <a href="contato.html" class="button">Agendar Consulta</a>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-contact-info">
            <p><i class="fas fa-phone-alt"></i> (44) 9968-9629</p>
            <p><i class="fas fa-envelope"></i> contato@akrofisio.com.br</p>
            <p><i class="fas fa-map-marker-alt"></i> Av. Exemplo, 123 - Centro, Cidade - UF</p>
            <ul class="footer-social-icons">
                <li><a href="https://www.instagram.com/akrofisio/" target="_blank" rel="noopener noreferrer" title="Instagram"><i class="fab fa-instagram"></i></a></li>
                <li><a href="https://wa.me/554499689629" target="_blank" rel="noopener noreferrer" title="WhatsApp"><i class="fab fa-whatsapp"></i></a></li>
            </ul>
            <div class="container">
                <p>&copy; 2025 Clínica de Fisioterapia AKROFISIO. Todos os direitos reservados.</p>
                <nav>
                    <!-- Links do rodapé, se houver -->
                </nav>
            </div>
        </div>
    </footer>

    <!-- Botão "Voltar ao Topo" -->
    <button id="scroll-to-top" aria-label="Voltar ao topo">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Estrutura do Lightbox/Modal de Imagem -->
    <div id="lightbox-modal">
        <span class="close-button" aria-label="Fechar imagem">X</span>
        <img id="lightbox-image" src="" alt="Imagem em destaque">
    </div>

    <script src="js/script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
    // --- Variáveis Globais e Seletores de Elementos ---

    // Menu Hambúrguer
    const menuToggle = document.querySelector('.menu-toggle');
    const mainNav = document.querySelector('.main-nav');
    const navList = document.querySelector('#nav-list');
    const pageHeader = document.querySelector('header'); // Seleciona o elemento <header>

    // Formulário de Contato Flutuante (Contato Rápido)
    const contactFormWrapper = document.getElementById('contact-form-wrapper'); // O container arrastável do formulário
    const openFormButton = document.getElementById('open-form-button'); // O botão "Contato Rápido"
    const closeFormButton = document.getElementById('close-form-button');
    const contactFormContent = document.getElementById('contact-form-content'); // O conteúdo do formulário em si
    const quickContactForm = document.getElementById('quick-contact-form');
    const formFeedback = document.querySelector('.form-feedback'); // Parágrafo para feedback do formulário rápido

    // Elementos para animação de aparição ao rolar (Scroll Reveal)
    const ambienteItems = document.querySelectorAll('.ambiente-item');
    const servicoItems = document.querySelectorAll('.servico-item'); // Pode não existir em todas as páginas

    // Para o botão de "Voltar ao Topo"
    const scrollToTopButton = document.getElementById('scroll-to-top');

    // Para a lógica de esconder/mostrar header e formulário flutuante ao rolar
    let lastScrollY = window.scrollY;

    // Lightbox/Modal de Imagem
    const lightboxModal = document.getElementById('lightbox-modal');
    const lightboxImage = document.getElementById('lightbox-image');
    const lightboxCloseButton = document.querySelector('#lightbox-modal .close-button');

    // --- Funções Auxiliares ---

    /**
     * Função para fechar o menu hambúrguer, removendo as classes 'open' e 'active'.
     */
    const closeMenu = () => {
        if (menuToggle && mainNav) {
            menuToggle.classList.remove('open');
            mainNav.classList.remove('active');
            menuToggle.setAttribute('aria-expanded', 'false');
        }
    };

    /**
     * Alterna a visibilidade do formulário de contato flutuante.
     * Esconde o botão 'Contato Rápido' quando o formulário está visível e vice-versa.
     */
    function toggleFormVisibility() {
        if (contactFormContent && openFormButton) {
            // Alterna as classes de visibilidade
            const isVisible = contactFormContent.classList.toggle('form-hidden'); // Retorna true se 'form-hidden' foi adicionado, false se removido
            contactFormContent.classList.toggle('form-visible', !isVisible); // 'form-visible' é o oposto de 'form-hidden'

            // Atualiza o atributo aria-expanded para acessibilidade
            openFormButton.setAttribute('aria-expanded', contactFormContent.classList.contains('form-visible'));

            // Controla a exibição do botão "Contato Rápido"
            if (contactFormContent.classList.contains('form-visible')) {
                openFormButton.style.display = 'none'; // Esconde o botão quando o formulário está aberto
            } else {
                openFormButton.style.display = 'flex'; // Mostra o botão quando o formulário está fechado (flex para ícone+texto)
            }
        }
    }

    /**
     * Valida os campos do formulário principal de contato (geralmente encontrado em 'contato.html').
     * Assume que os elementos de erro (ex: <span id="name-error" class="error-message"></span>)
     * existem no HTML para cada campo.
     * @returns {boolean} True se o formulário for válido, False caso contrário.
     */
    function validateMainContactForm() {
        // Limpa todas as mensagens de erro anteriores
        document.querySelectorAll('.error-message').forEach(el => el.textContent = '');

        let isValid = true; // Flag de validação

        // Seletores de campos e mensagens de erro para o formulário principal
        const nameInput = document.getElementById('name');
        const emailInput = document.getElementById('email');
        const messageInput = document.getElementById('message');

        const nameError = document.getElementById('name-error');
        const emailError = document.getElementById('email-error');
        const messageError = document.getElementById('message-error');

        // Validação do campo Nome
        if (nameInput && nameError) { // Verifica se os elementos existem antes de tentar acessá-los
            if (nameInput.value.trim() === '') {
                nameError.textContent = 'O nome é obrigatório.';
                isValid = false;
            }
        }

        // Validação do campo Email
        if (emailInput && emailError) {
            if (emailInput.value.trim() === '') {
                emailError.textContent = 'O e-mail é obrigatório.';
                isValid = false;
            } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailInput.value.trim())) {
                emailError.textContent = 'Por favor, insira um e-mail válido.';
                isValid = false;
            }
        }

        // Validação do campo Mensagem
        if (messageInput && messageError) {
            if (messageInput.value.trim() === '') {
                messageError.textContent = 'A mensagem é obrigatório.';
                isValid = false;
            } else if (messageInput.value.trim().length < 10) {
                messageError.textContent = 'A mensagem deve ter pelo menos 10 caracteres.';
                isValid = false;
            }
        }

        return isValid;
    }

    /**
     * Abre o lightbox com a imagem especificada.
     * @param {string} imgSrc - O caminho da imagem a ser exibida no lightbox.
     * @param {string} imgAlt - O texto alternativo (alt) da imagem.
     */
    function openLightbox(imgSrc, imgAlt) {
        if (lightboxModal && lightboxImage) {
            lightboxImage.src = imgSrc;
            lightboxImage.alt = imgAlt;
            lightboxModal.classList.add('active');
            document.body.style.overflow = 'hidden'; // Evita rolagem da página quando o modal está aberto
        }
    }

    /**
     * Fecha o lightbox.
     */
    function closeLightbox() {
        if (lightboxModal && lightboxImage) {
            lightboxModal.classList.remove('active');
            document.body.style.overflow = ''; // Restaura a rolagem da página
            lightboxImage.src = ''; // Limpa a imagem para otimização
        }
    }

    // --- Event Listeners e Lógica Principal ---

    // Lógica para Abrir/Fechar o Menu Hambúrguer em telas menores
    if (menuToggle && mainNav && navList) {
        menuToggle.addEventListener('click', function() {
            const isExpanded = menuToggle.getAttribute('aria-expanded') === 'true';
            menuToggle.classList.toggle('open'); // Adiciona/remove classe para animação do ícone
            mainNav.classList.toggle('active'); // Adiciona/remove classe para mostrar/esconder o menu
            menuToggle.setAttribute('aria-expanded', !isExpanded); // Atualiza o estado de acessibilidade
        });

        // Fecha o menu mobile se um link de navegação for clicado
        navList.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', function() {
                if (mainNav.classList.contains('active')) { // Verifica se o menu está aberto
                    closeMenu(); // Chama a função para fechar o menu
                }
            });
        });
    }

    // --- Animação de Aparição ao Rolar (Scroll Reveal) ---
    // Cria um observador para detectar quando elementos específicos entram na viewport.
    const handleIntersect = (entries, observer) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                // Se o elemento está visível, adiciona a classe 'aparecer'
                entry.target.classList.add('aparecer');
                // Para de observar este elemento para que a animação não se repita
                observer.unobserve(entry.target);
            }
        });
    };

    // Define as opções para o Intersection Observer
    const observerOptions = {
        root: null, // Observa a viewport (elemento raiz padrão)
        threshold: 0.2, // Ativa quando 20% do elemento está visível
        rootMargin: '0px' // Sem margem extra para o root
    };

    // Instancia o Intersection Observer com a função de callback e opções
    const observer = new IntersectionObserver(handleIntersect, observerOptions);

    // Observa todos os elementos com a classe 'ambiente-item' (usados na página de estrutura)
    if (ambienteItems.length > 0) {
        ambienteItems.forEach(item => {
            observer.observe(item);
        });
    }
    // Observa os elementos com a classe 'servico-item' (usados na página de serviços), se existirem
    if (servicoItems.length > 0) {
        servicoItems.forEach(item => {
            observer.observe(item);
        });
    }

    // --- Lógica do Formulário de Contato Flutuante (Abrir/Fechar e Arrastar) ---
    // A variável para controle de arrasto
    let isDraggingForm = false;
    let offsetXForm, offsetYForm;
    const dragHandle = openFormButton; // O botão de abertura serve como a "alça" para arrastar o formulário

    if (contactFormWrapper && dragHandle && contactFormContent) {
        dragHandle.addEventListener('mousedown', (e) => {
            // Captura as coordenadas iniciais do mouse
            let initialX = e.clientX;
            let initialY = e.clientY;
            const moveThreshold = 5; // Limiar de movimento em pixels para considerar arrasto

            // Função para verificar se o mouse se moveu o suficiente para iniciar o arrasto
            const onMouseMoveForDrag = (moveEvent) => {
                const deltaX = Math.abs(moveEvent.clientX - initialX);
                const deltaY = Math.abs(moveEvent.clientY - initialY);

                if (deltaX > moveThreshold || deltaY > moveThreshold) {
                    isDraggingForm = true; // Define o estado de arrasto como verdadeiro
                    contactFormWrapper.classList.add('dragging'); // Adiciona classe visual de arrasto
                    contactFormWrapper.style.position = 'fixed'; // Garante posicionamento fixo
                    contactFormWrapper.style.zIndex = '1000'; // Garante que fique acima de outros elementos
                    contactFormWrapper.style.bottom = 'auto'; // Remove ancoragem ao bottom
                    contactFormWrapper.style.right = 'auto'; // Remove ancoragem ao right

                    // Calcula o offset inicial para o arrasto (distância do clique ao canto do elemento)
                    const rect = contactFormWrapper.getBoundingClientRect();
                    offsetXForm = initialX - rect.left;
                    offsetYForm = initialY - rect.top;

                    // Remove este listener temporário de mousemove assim que o arrasto é detectado
                    document.removeEventListener('mousemove', onMouseMoveForDrag);
                }
            };

            // Função para lidar com a liberação do clique (mouseup)
            const onMouseUpForDrag = () => {
                // Remove os listeners temporários de mousemove e mouseup
                document.removeEventListener('mousemove', onMouseMoveForDrag);
                document.removeEventListener('mouseup', onMouseUpForDrag);

                // Se não houve arrasto (apenas um clique), alterna a visibilidade do formulário
                if (!isDraggingForm) {
                    toggleFormVisibility();
                }
                isDraggingForm = false; // Reseta o estado de arrasto
                contactFormWrapper.classList.remove('dragging'); // Remove a classe visual de arrasto
                contactFormWrapper.style.cursor = 'grab'; // Restaura o cursor
            };

            // Adiciona os listeners temporários
            document.addEventListener('mousemove', onMouseMoveForDrag);
            document.addEventListener('mouseup', onMouseUpForDrag);

            e.preventDefault(); // Previne o comportamento padrão do mousedown (ex: seleção de texto)
        });

        // Este listener de mousemove lida com o movimento real do formulário APÓS o arrasto ter sido iniciado
        document.addEventListener('mousemove', (e) => {
            if (!isDraggingForm) return; // Só move se estiver no estado de arrasto
            e.preventDefault(); // Previne seleção de texto durante o arrasto

            let newX = e.clientX - offsetXForm;
            let newY = e.clientY - offsetYForm;

            // Limita o formulário à área visível da tela
            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;
            const draggableWidth = contactFormWrapper.offsetWidth;
            const draggableHeight = contactFormWrapper.offsetHeight;

            // Garante que o formulário não saia dos limites da viewport
            if (newX < 0) newX = 0;
            if (newX + draggableWidth > viewportWidth) newX = viewportWidth - draggableWidth;
            if (newY < 0) newY = 0;
            if (newY + draggableHeight > viewportHeight) newY = viewportHeight - draggableHeight;

            // Aplica as novas posições
            contactFormWrapper.style.left = `${newX}px`;
            contactFormWrapper.style.top = `${newY}px`;
        });

        // Previne o comportamento padrão de arrastar imagens ou links que podem estar no botão
        dragHandle.ondragstart = function() { return false; };
    }

    // Lógica de Envio do Formulário Rápido (Formspree.io)
    if (quickContactForm && formFeedback) {
        quickContactForm.addEventListener('submit', async (event) => {
            event.preventDefault(); // Impede o envio padrão do formulário

            formFeedback.textContent = 'Enviando...'; // Mensagem de feedback inicial
            formFeedback.classList.remove('error', 'success'); // Limpa classes de feedback anteriores

            const formData = new FormData(quickContactForm);
            // ATENÇÃO: Substitua 'YOUR_FORMSPREE_ID' pelo seu ID real do Formspree!
            try {
                const response = await fetch("https://formspree.io/f/YOUR_FORMSPREE_ID", {
                    method: 'POST', // Método de envio sempre POST para Formspree
                    body: formData,
                    headers: {
                        'Accept': 'application/json' // Solicita resposta JSON do Formspree
                    }
                });

                if (response.ok) { // Se a resposta for bem-sucedida (status 2xx)
                    formFeedback.textContent = 'Mensagem enviada com sucesso! Em breve entraremos em contato.';
                    formFeedback.classList.add('success'); // Adiciona classe de sucesso
                    formFeedback.style.display = 'block'; // Garante que a mensagem esteja visível
                    quickContactForm.reset(); // Limpa todos os campos do formulário

                    // Esconde o formulário e a mensagem após 5 segundos
                    setTimeout(() => {
                        formFeedback.style.display = 'none';
                        toggleFormVisibility(); // Esconde o formulário
                    }, 5000);
                } else { // Se a resposta não for bem-sucedida
                    const data = await response.json(); // Tenta parsear a resposta JSON para obter erros
                    let errorMessage = 'Ocorreu um erro ao enviar a mensagem. Tente novamente.';
                    if (data.errors) {
                        errorMessage = data.errors.map(error => error.message).join(', ');
                    }
                    formFeedback.textContent = errorMessage;
                    formFeedback.classList.add('error'); // Adiciona classe de erro
                    formFeedback.style.display = 'block'; // Garante que a mensagem esteja visível

                    // Esconde a mensagem de erro após 5 segundos
                    setTimeout(() => {
                        formFeedback.style.display = 'none';
                    }, 5000);
                }
            } catch (error) { // Lida com erros de rede (ex: sem internet)
                formFeedback.textContent = 'Não foi possível conectar ao servidor. Verifique sua conexão.';
                formFeedback.classList.add('error');
                console.error('Erro de rede ao enviar formulário rápido:', error);
            }
        });
    }


    // Lógica para Esconder/Mostrar o HEADER e o Formulário Flutuante ao rolar a página
    if (pageHeader && contactFormWrapper && contactFormContent) {
        window.addEventListener('scroll', function() {
            // Verifica se o menu mobile está aberto ou o formulário flutuante está visível
            const shouldAlwaysShow = (mainNav && mainNav.classList.contains('active')) || contactFormContent.classList.contains('form-visible');

            if (window.scrollY > lastScrollY && window.scrollY > 150 && !shouldAlwaysShow) {
                // Rolando para baixo, e já passou de 150px, e nem o menu nem o formulário estão abertos
                pageHeader.classList.add('hidden'); // Esconde o header
                contactFormWrapper.classList.add('hidden'); // Esconde o formulário flutuante
            } else if (window.scrollY < lastScrollY || window.scrollY <= 50 || shouldAlwaysShow) {
                // Rolando para cima, ou está nos primeiros 50px do topo, ou o menu/formulário está aberto
                pageHeader.classList.remove('hidden'); // Mostra o header
                contactFormWrapper.classList.remove('hidden'); // Mostra o formulário flutuante
            }
            lastScrollY = window.scrollY; // Atualiza a última posição de rolagem
        });
    }

    // Lógica para feedback de formulário principal usando parâmetros de URL (se a página de contato redirecionar)
    // Esta parte é útil se um formulário principal for enviado para um backend que redireciona com um status na URL.
    const urlParams = new URLSearchParams(window.location.search);
    const status = urlParams.get('status');
    const formStatusMessageMain = document.querySelector('.form-status-message-main'); // O elemento para feedback do formulário principal

    if (status && formStatusMessageMain) {
        let messageDiv = document.createElement('div');
        messageDiv.classList.add('form-status-message');
        messageDiv.textContent = '';

        if (status === 'success') {
            messageDiv.textContent = 'Mensagem enviada com sucesso! Em breve entraremos em contato.';
            messageDiv.classList.add('success');
        } else if (status === 'error') {
            messageDiv.textContent = 'Ocorreu um erro ao enviar a mensagem. Por favor, tente novamente mais tarde.';
            messageDiv.classList.add('error');
        }

        formStatusMessageMain.appendChild(messageDiv);
        // Limpa os parâmetros da URL para evitar que a mensagem reapareça no refresh da página
        window.history.replaceState({}, document.title, window.location.pathname);
    }

    // --- Validação e Envio do Formulário Principal de Contato (se presente na página) ---
    // Este bloco de código se aplica a um formulário de contato "fixo" na página (não o flutuante).
    const mainContactForm = document.querySelector('.main-contact-form');
    if (mainContactForm) {
        mainContactForm.addEventListener('submit', async function(event) {
            event.preventDefault(); // Impede o envio padrão do formulário HTML

            const isValid = validateMainContactForm(); // Executa a validação

            if (!isValid) {
                // Se o formulário não for válido, rola até o primeiro campo com erro para o usuário corrigir
                const firstInvalidElement = document.querySelector('.error-message:not(:empty)');
                if (firstInvalidElement) {
                    firstInvalidElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
                return; // Impede o envio do formulário
            }

            // Se o formulário for válido, procede com o envio via AJAX (Formspree)
            const formData = new FormData(mainContactForm);
            const formspreeAction = mainContactForm.action; // Pega o atributo 'action' do HTML do formulário

            try {
                const response = await fetch(formspreeAction, {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'Accept': 'application/json'
                    }
                });

                if (response.ok) {
                    // Exibe feedback de sucesso, se o elemento de feedback estiver disponível
                    if (formStatusMessageMain) {
                        formStatusMessageMain.textContent = 'Mensagem enviada com sucesso! Em breve entraremos em contato.';
                        formStatusMessageMain.classList.remove('error');
                        formStatusMessageMain.classList.add('success');
                        formStatusMessageMain.style.display = 'block';
                        mainContactForm.reset(); // Limpa o formulário
                        setTimeout(() => {
                            formStatusMessageMain.style.display = 'none';
                        }, 5000);
                    } else {
                        // Se o elemento de feedback não existe, loga no console
                        console.log('Mensagem enviada com sucesso! (Feedback via console)');
                        mainContactForm.reset();
                    }
                } else {
                    // Exibe feedback de erro
                    const data = await response.json();
                    let errorMessage = 'Ocorreu um erro ao enviar a mensagem. Tente novamente.';
                    if (data.errors) {
                        errorMessage = data.errors.map(error => error.message).join(', ');
                    }
                    if (formStatusMessageMain) {
                        formStatusMessageMain.textContent = errorMessage;
                        formStatusMessageMain.classList.remove('success');
                        formStatusMessageMain.classList.add('error');
                        formStatusMessageMain.style.display = 'block';
                        setTimeout(() => {
                            formStatusMessageMain.style.display = 'none';
                        }, 5000);
                    } else {
                        console.error('Erro ao enviar mensagem:', errorMessage);
                    }
                }
            } catch (error) { // Lida com erros de conexão de rede
                console.error('Erro de conexão ao enviar o formulário principal:', error);
                if (formStatusMessageMain) {
                    formStatusMessageMain.textContent = 'Erro de conexão. Por favor, tente novamente mais tarde.';
                    formStatusMessageMain.classList.remove('success');
                    formStatusMessageMain.classList.add('error');
                    formStatusMessageMain.style.display = 'block';
                    setTimeout(() => {
                        formStatusMessageMain.style.display = 'none';
                    }, 5000);
                }
            }
        });
    }

    // --- Botão Voltar ao Topo ---
    // Verifica se o botão "Voltar ao Topo" existe no HTML
    if (scrollToTopButton) {
        // Mostra/esconde o botão com base na posição de rolagem
        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) { // Mostra o botão após rolar 300px
                scrollToTopButton.classList.add('show');
            } else {
                scrollToTopButton.classList.remove('show');
            }
        });

        // Adiciona um evento de clique para rolar suavemente para o topo da página
        scrollToTopButton.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth' // Rola suavemente
            });
        });
    }

    // --- Lógica do Lightbox/Modal de Imagem ---
    // Adiciona listener de clique a todas as imagens dentro de .ambiente-gallery
    document.querySelectorAll('.ambiente-gallery img').forEach(img => {
        img.addEventListener('click', function() {
            const fullSrc = this.getAttribute('data-fullsrc') || this.src; // Pega o caminho da imagem grande
            const altText = this.alt; // Pega o texto alt da imagem
            openLightbox(fullSrc, altText);
        });
    });

    // Fecha o lightbox ao clicar no botão 'X'
    if (lightboxCloseButton) {
        lightboxCloseButton.addEventListener('click', closeLightbox);
    }

    // Fecha o lightbox ao clicar fora da imagem (no fundo escuro do modal)
    if (lightboxModal) {
        lightboxModal.addEventListener('click', function(event) {
            // Se o clique foi diretamente no background do modal e não na imagem
            if (event.target === lightboxModal) {
                closeLightbox();
            }
        });
    }
});

document.addEventListener('DOMContentLoaded', function() {
    // --- Variáveis Globais e Seletores de Elementos ---

    // Menu Hambúrguer
    const menuToggle = document.querySelector('.menu-toggle');
    const mainNav = document.querySelector('.main-nav');
    const navList = document.querySelector('#nav-list');

    // Formulário de Contato Flutuante (Contato Rápido)
    const openFormButton = document.getElementById('open-form-button');
    const closeFormButton = document.getElementById('close-form-button');
    const contactFormContent = document.getElementById('contact-form-content');
    const quickContactForm = document.getElementById('quick-contact-form');
    const formFeedback = document.querySelector('.form-feedback');
    const draggableWrapper = document.getElementById('contact-form-wrapper');

    // Elementos da Página e Rolagem
    const pageHeader = document.querySelector('header');
    let lastScrollY = window.scrollY;

    // Itens de Serviço para Animação de Scroll
    const serviceItems = document.querySelectorAll(".servico-item");


    // --- Funções Auxiliares ---

    /**
     * Alterna a visibilidade do formulário de contato flutuante.
     */
    function toggleFormVisibility() {
        if (contactFormContent && openFormButton) {
            contactFormContent.classList.toggle('form-hidden');
            contactFormContent.classList.toggle('form-visible');
            openFormButton.setAttribute('aria-expanded', contactFormContent.classList.contains('form-visible'));
        }
    }

    /**
     * Verifica e adiciona a classe 'aparecer' aos itens de serviço quando entram no viewport.
     */
    function checkServiceItemsVisibility() {
        serviceItems.forEach((item) => {
            const posicao = item.getBoundingClientRect().top;
            const alturaTela = window.innerHeight;

            // Se o item está visível na tela (com uma pequena margem de 100px)
            if (posicao < alturaTela - 100) {
                item.classList.add("aparecer");
            }
            // Opcional: Se quiser que eles desapareçam ao rolar para cima, você pode adicionar um 'else' aqui
            // else {
            //     item.classList.remove("aparecer");
            // }
        });
    }

    // --- Event Listeners e Lógica Principal ---

    // Lógica do Menu Hambúrguer
    if (menuToggle && mainNav && navList) {
        menuToggle.addEventListener('click', function() {
            const isExpanded = menuToggle.getAttribute('aria-expanded') === 'true';
            menuToggle.classList.toggle('open');
            mainNav.classList.toggle('active');
            menuToggle.setAttribute('aria-expanded', !isExpanded);
        });

        navList.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', function() {
                if (mainNav.classList.contains('active')) {
                    menuToggle.classList.remove('open');
                    mainNav.classList.remove('active');
                    menuToggle.setAttribute('aria-expanded', 'false');
                }
            });
        });
    }

    // Lógica para Abrir/Fechar o Formulário de Contato Flutuante
    if (openFormButton) {
        openFormButton.addEventListener('click', toggleFormVisibility);
    }
    if (closeFormButton) {
        closeFormButton.addEventListener('click', toggleFormVisibility);
    }

    // Lógica de Envio do Formulário Rápido (Formspree)
    if (quickContactForm && formFeedback) {
        quickContactForm.addEventListener('submit', async (event) => {
            event.preventDefault();

            const formData = new FormData(quickContactForm);
            const response = await fetch("https://formspree.io/f/YOUR_FORMSPREE_ID", { // Use o ID do seu Formspree aqui
                method: quickContactForm.method,
                body: formData,
                headers: {
                    'Accept': 'application/json'
                }
            });

            if (response.ok) {
                formFeedback.textContent = 'Mensagem enviada com sucesso! Em breve entraremos em contato.';
                formFeedback.classList.remove('error');
                formFeedback.classList.add('success');
                formFeedback.style.display = 'block';
                quickContactForm.reset();
                setTimeout(() => {
                    formFeedback.style.display = 'none';
                    toggleFormVisibility();
                }, 5000);
            } else {
                const data = await response.json();
                let errorMessage = 'Ocorreu um erro ao enviar a mensagem. Tente novamente.';
                if (data.errors) {
                    errorMessage = data.errors.map(error => error.message).join(', ');
                }
                formFeedback.textContent = errorMessage;
                formFeedback.classList.remove('success');
                formFeedback.classList.add('error');
                formFeedback.style.display = 'block';
                setTimeout(() => {
                    formFeedback.style.display = 'none';
                }, 5000);
            }
        });
    }

    // Lógica para Arrastar o Formulário Flutuante
    let isDragging = false;
    let offsetX, offsetY;
    const dragHandle = openFormButton;

    if (draggableWrapper && dragHandle && contactFormContent) {
        dragHandle.addEventListener('mousedown', (e) => {
            if (!contactFormContent.classList.contains('form-visible')) {
                return;
            }
            isDragging = true;
            draggableWrapper.style.position = 'fixed';
            draggableWrapper.style.zIndex = '1000';
            draggableWrapper.style.bottom = 'auto';
            draggableWrapper.style.right = 'auto';
            const rect = draggableWrapper.getBoundingClientRect();
            offsetX = e.clientX - rect.left;
            offsetY = e.clientY - rect.top;
            draggableWrapper.classList.add('dragging');
            e.preventDefault();
        });

        document.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            let newX = e.clientX - offsetX;
            let newY = e.clientY - offsetY;
            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;
            const draggableWidth = draggableWrapper.offsetWidth;
            const draggableHeight = draggableWrapper.offsetHeight;

            if (newX < 0) newX = 0;
            if (newX + draggableWidth > viewportWidth) newX = viewportWidth - draggableWidth;
            if (newY < 0) newY = 0;
            if (newY + draggableHeight > viewportHeight) newY = viewportHeight - draggableHeight;

            draggableWrapper.style.left = `${newX}px`;
            draggableWrapper.style.top = `${newY}px`;
        });

        document.addEventListener('mouseup', () => {
            isDragging = false;
            draggableWrapper.classList.remove('dragging');
        });

        if (dragHandle) {
            dragHandle.ondragstart = function() { return false; };
        }
    }

    // Lógica para Esconder/Mostrar HEADER e Formulário Flutuante ao rolar
    if (pageHeader && mainNav && draggableWrapper && contactFormContent) {
        window.addEventListener('scroll', function() {
            let shouldShowHeaderOrForm = mainNav.classList.contains('active') || contactFormContent.classList.contains('form-visible');

            if (window.scrollY > lastScrollY && window.scrollY > 150 && !shouldShowHeaderOrForm) {
                pageHeader.classList.add('hidden');
                draggableWrapper.classList.add('hidden');
            } else if (window.scrollY < lastScrollY || window.scrollY <= 50 || shouldShowHeaderOrForm) {
                pageHeader.classList.remove('hidden');
                draggableWrapper.classList.remove('hidden');
            }
            lastScrollY = window.scrollY;
        });
    }

    // --- Lógica para a seção de serviços aparecer ao rolar ---
    // Chama a função ao carregar a página e também a cada rolagem
    checkServiceItemsVisibility(); // Verifica ao carregar

    // Adiciona o listener para o evento de rolagem
    window.addEventListener('scroll', checkServiceItemsVisibility);

    // Lógica para feedback de formulário principal (URL params - MENOS USADO NESTA PÁGINA)
    const urlParams = new URLSearchParams(window.location.search);
    const status = urlParams.get('status');
    const formStatusMessageMain = document.querySelector('.form-status-message-main'); // Pode não existir nesta página, mas mantém para compatibilidade

    if (status && formStatusMessageMain) {
        let messageDiv = document.createElement('div');
        messageDiv.classList.add('form-status-message');
        messageDiv.textContent = '';

        if (status === 'success') {
            messageDiv.textContent = 'Mensagem enviada com sucesso! Em breve entraremos em contato.';
            messageDiv.classList.add('success');
        } else if (status === 'error') {
            messageDiv.textContent = 'Ocorreu um erro ao enviar a mensagem. Por favor, tente novamente mais tarde.';
            messageDiv.classList.add('error');
        }

        formStatusMessageMain.appendChild(messageDiv);
        window.history.replaceState({}, document.title, window.location.pathname);
    }
});


    </script>
</body>
</html>
